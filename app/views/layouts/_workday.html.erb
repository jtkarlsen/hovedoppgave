<div id="mainTable">
	<table class="table table-striped table-hover" id="parent_table">
		<thead>
			<tr>
				<th>Navn</th>
				<th>Dato</th>
				<th>Timer</th>
				<th>Status</th>
			</tr>

		</thead>
		<tbody>
			<% @workdays.each_with_index do |day, index|%>
			<tr class="parent" id=row<%= index%>>

				<td class="row_button" id=<%= index%>><%= day[:day].user.name %></td>
				<td class="row_button" id=<%= index%>><%= day[:day].date %></td>
				<% if day[:day].supervisor_hour == nil%>
				<td class="row_button" id=<%= index%>><%= day[:sum]%></td>
				<% else%>
				<td class="row_button" id=<%= index%>><%= day[:day].supervisor_hour%> </td>
				<% end%>
				<% if day[:day].approved != nil%>
					<% if day[:day].approved%>
						<% if day[:day].supervisor_hour == nil%>
							<td colspan="3" style="text-align: center"><span class="last_td label label-success">Timene er allerede godkjent</span></td>
						<%else%>
							<td colspan="3" style="text-align: center"><span class="last_td label label-warning">Timene har blitt forandret av formann</span></td>
						<%end%>
					<%else%>
						<td colspan="3" style="text-align: center"><span class="last_td label label-important">Timene er blitt underkjent</span></td>
					<%end%>
				<%else%>
				<div id="myModal<%=index%>" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
					<div class="modal-body">
						<h1>Legg til en ny jobbdag for bruker: <h2><%= day[:day].user.name%></h2></h1>
						<div class="row">
							<div class="span3 offsett3">
								<%= form_for([day[:day].user, day[:day]]) do |f| %>
								<%= f.text_area :comment, placeholder: "Kommentar til manuell innlegg av timer...", :cols => 20, :rows => 5 %>
								<%= f.number_field :supervisor_hour, placeholder: "Antall timer..." %>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button class="btn" data-dismiss="modal" aria-hidden="true">
							Close
						</button>
						<%= f.submit "Lagre", {class: "btn btn-large btn-primary"}%>
						<% end %>
					</div>
					</div>
					<td id=last_td<%= index%>> <%= button_to  "Godkjenn timer", { :action => "update", :id => day[:day].id, :user_id => day[:day].user.id, approved: true},
					{class: "approve_buttons btn btn-small btn-success button_row#{index}" , id: "#{index}",
					:confirm => "Are you sure?", form_class: "approve_form"}%>
					<button type="button" id=<%= index%> class="button_row<%= index%> btn btn-warning btn-small approve_buttons open_modal" data-id=<%=index%>>
						Delvis godkjenn
					</button> 
					<%= button_to  "Underkjenn timer", { :action => "update", :id => day[:day].id, :user_id => day[:day].user.id, approved: false},
					{class: "approve_buttons btn-small btn btn-danger button_row#{index}" ,id: "#{index}",
					:confirm => "Are you sure?", form_class: "approve_form"}%> </td>
					<%end%>
			</tr>
			<tr class="child_row" id="child<%= index%>">

				<td colspan="3">
				<table id="child-table" class='table child-table'>
					<thead>
						<tr id='child-head'>
							<th>Start:</th>
							<th>Stop:</th>
							<th>Antall:</th>
						</tr>
					</thead>
					<tbody>
						<% day[:day].workhours.each do |hour|%>
						<tr class="info">
							<td><%= hour[:start]%></td>
							<td><%= hour[:stop]%></td>
							<td><%= hour[:count]%></td>
						</tr>
						<%end%>
					</tbody>
				</table></td>

			</tr>
			<%end%>
		</tbody>
	</table>
</div>
